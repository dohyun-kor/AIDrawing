<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.example.model.dao.UserDao">

    <!-- 회원가입 -->
    <insert id="insert" parameterType="com.example.model.dto.SignUpDto">
    INSERT INTO Users
        (id,
         password,
         nickname)
        VALUES (#{id},
                #{password},
                #{nickname})
    </insert>

    <!-- 로그인 시 ID로 사용자 조회 -->
    <select id="findById" resultType="com.example.model.dto.UserDto">
        SELECT * FROM Users WHERE id = #{id}
    </select>

    <!-- 닉네임 중복 여부 확인 -->
    <select id="existsByNickname" parameterType="string" resultType="boolean">
        SELECT COUNT(*) > 0
        FROM Users
        WHERE nickname = #{nickname}
    </select>

    <!-- id로 userId 조회-->
    <select id="getUserIdById" parameterType="string" resultType="int">
        SELECT user_id AS userId
        FROM Users
        WHERE id = #{id}
    </select>

    <!-- 유저 ID로 유저 정보 조회-->
    <select id="findByUserId" parameterType="int" resultType="com.example.model.dto.UserDto">
        SELECT * FROM Users WHERE user_id = #{userId}
    </select>

    <!-- userId로 point 조회-->
    <select id="findPointByUserId" parameterType="int" resultType="int">
        SELECT points
        From Users
        where user_id = #{userId}
    </select>

    <!-- point update-->
    <update id="updatePoint">
        UPDATE Users
        SET points = #{points}
        WHERE user_id = #{userId}
    </update>

    <update id="changeProfile" parameterType="java.util.Map">
        UPDATE Users
        SET userProfileItemId = #{itemId}
        WHERE user_id = #{userId}
    </update>

</mapper>
